

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>train_nn_torch_bs module &mdash; EELSfitter 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> EELSfitter
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/datasets.html">Datasets</a></li>
</ul>
<p class="caption"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../theory/kk_analysis.html">Kramer-Kronig Analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Implementation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../implementation/training_strategies.html">Training Strategies</a></li>
</ul>
<p class="caption"><span class="caption-text">Results</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../results/EELS_10.html">EELS 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../results/EELS_20.html">EELS 2.0</a></li>
</ul>
<p class="caption"><span class="caption-text">Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EELSfitter</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>train_nn_torch_bs module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/modules/train_nn_torch_bs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-train_nn_torch_bs">
<span id="train-nn-torch-bs-module"></span><h1>train_nn_torch_bs module<a class="headerlink" href="#module-train_nn_torch_bs" title="Permalink to this headline">¶</a></h1>
<p>Created on Wed Feb 24 22:24:31 2021</p>
<p>&#64;author: isabel</p>
<dl class="py function">
<dt id="train_nn_torch_bs.CI_high">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">CI_high</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">confidence</span><span class="o">=</span><span class="default_value">0.68</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#CI_high"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.CI_high" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.CI_low">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">CI_low</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">confidence</span><span class="o">=</span><span class="default_value">0.68</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#CI_low"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.CI_low" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.MC_reps">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">MC_reps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_avg</span></em>, <em class="sig-param"><span class="n">data_std</span></em>, <em class="sig-param"><span class="n">n_rep</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#MC_reps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.MC_reps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="train_nn_torch_bs.MLP">
<em class="property">class </em><code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">MLP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_inputs</span></em>, <em class="sig-param"><span class="n">num_outputs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#MLP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.MLP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="py method">
<dt id="train_nn_torch_bs.MLP.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#MLP.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.MLP.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="train_nn_torch_bs.MLP.training">
<code class="sig-name descname">training</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#train_nn_torch_bs.MLP.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.binned_statistics">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">binned_statistics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">nbins</span></em>, <em class="sig-param"><span class="n">stats</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#binned_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.binned_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the mean, variance and number of counts within the bins described by ewd</p>
</dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.derivative_clusters">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">derivative_clusters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">clusters</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#derivative_clusters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.derivative_clusters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.determine_dE1_new">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">determine_dE1_new</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">dy_dx_clusters</span></em>, <em class="sig-param"><span class="n">y_smooth_clusters</span></em>, <em class="sig-param"><span class="n">check_with_user</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#determine_dE1_new"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.determine_dE1_new" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.ewd">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">ewd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">nbins</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#ewd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.ewd" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>INPUT:</dt><dd><p>x:
y:
nbins:</p>
</dd>
<dt>OUTPUT:</dt><dd><p>df_train:
cuts1:
cuts2:</p>
</dd>
</dl>
<p>Apply Equal Width Discretization (EWD) to x and y data to determine variances</p>
</dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.find_dE1">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">find_dE1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">dy_dx</span></em>, <em class="sig-param"><span class="n">y_smooth</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#find_dE1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.find_dE1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.find_scale_var">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">find_scale_var</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span></em>, <em class="sig-param"><span class="n">min_out</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">max_out</span><span class="o">=</span><span class="default_value">0.9</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#find_scale_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.find_scale_var" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.get_mean">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">get_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#get_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.get_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.get_median">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">get_median</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">nbins</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#get_median"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.get_median" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.loss_fn">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">loss_fn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">output</span></em>, <em class="sig-param"><span class="n">target</span></em>, <em class="sig-param"><span class="n">error</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#loss_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.loss_fn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.scale">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span></em>, <em class="sig-param"><span class="n">ab</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>min_inp = inp.min()
max_inp = inp.max()</p>
<p>outp = inp/(max_inp-min_inp) * (max_out-min_out)
outp -= outp.min()
outp += min_out</p>
<p>return outp</p>
</dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.smooth">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">smooth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">window_len</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">'hanning'</span></em>, <em class="sig-param"><span class="n">keep_original</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#smooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the begining and end part of the output signal.</p>
<dl>
<dt>input:</dt><dd><p>x: the input signal
window_len: the dimension of the smoothing window; should be an odd integer
window: the type of window from ‘flat’, ‘hanning’, ‘hamming’, ‘bartlett’, ‘blackman’</p>
<blockquote>
<div><p>flat window will produce a moving average smoothing.</p>
</div></blockquote>
</dd>
<dt>output:</dt><dd><p>the smoothed signal</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.smooth_clusters">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">smooth_clusters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">clusters</span></em>, <em class="sig-param"><span class="n">window_len</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#smooth_clusters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.smooth_clusters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.split_test_train">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">split_test_train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">test_size</span><span class="o">=</span><span class="default_value">0.2</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#split_test_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.split_test_train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.train_nn">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">train_nn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">n_rep</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">n_epochs</span><span class="o">=</span><span class="default_value">30000</span></em>, <em class="sig-param"><span class="n">path_to_models</span><span class="o">=</span><span class="default_value">'models'</span></em>, <em class="sig-param"><span class="n">display_step</span><span class="o">=</span><span class="default_value">1000</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#train_nn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.train_nn" title="Permalink to this definition">¶</a></dt>
<dd><p>training also on intensity, so only one model per image, instead of one model per cluster</p>
</dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.train_nn_scaled">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">train_nn_scaled</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">spectra</span></em>, <em class="sig-param"><span class="n">n_rep</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">n_epochs</span><span class="o">=</span><span class="default_value">30000</span></em>, <em class="sig-param"><span class="n">lr</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">added_dE1</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">path_to_models</span><span class="o">=</span><span class="default_value">'models'</span></em>, <em class="sig-param"><span class="n">display_step</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">bs_rep_num</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#train_nn_scaled"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.train_nn_scaled" title="Permalink to this definition">¶</a></dt>
<dd><p>training also on intensity, so only one model per image, instead of one model per cluster</p>
</dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.user_check">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">user_check</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dE12</span></em>, <em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#user_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.user_check" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="train_nn_torch_bs.weight_reset">
<code class="sig-prename descclassname">train_nn_torch_bs.</code><code class="sig-name descname">weight_reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/train_nn_torch_bs.html#weight_reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#train_nn_torch_bs.weight_reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, A

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>