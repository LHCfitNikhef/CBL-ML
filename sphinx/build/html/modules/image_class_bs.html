

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>image_class_bs module &mdash; EELSfitter 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> EELSfitter
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/datasets.html">Datasets</a></li>
</ul>
<p class="caption"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../theory/kk_analysis.html">Kramer-Kronig Analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Implementation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../implementation/training_strategies.html">Training Strategies</a></li>
</ul>
<p class="caption"><span class="caption-text">Results</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../results/EELS_10.html">EELS 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../results/EELS_20.html">EELS 2.0</a></li>
</ul>
<p class="caption"><span class="caption-text">Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EELSfitter</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>image_class_bs module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/modules/image_class_bs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-image_class_bs">
<span id="image-class-bs-module"></span><h1>image_class_bs module<a class="headerlink" href="#module-image_class_bs" title="Permalink to this headline">¶</a></h1>
<p>Created on Fri Dec 18 17:38:57 2020</p>
<p>&#64;author: isabel</p>
<dl class="py function">
<dt id="image_class_bs.CFT">
<code class="sig-prename descclassname">image_class_bs.</code><code class="sig-name descname">CFT</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#CFT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.CFT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="image_class_bs.MLP">
<em class="property">class </em><code class="sig-prename descclassname">image_class_bs.</code><code class="sig-name descname">MLP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_inputs</span></em>, <em class="sig-param"><span class="n">num_outputs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#MLP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.MLP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="py method">
<dt id="image_class_bs.MLP.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#MLP.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.MLP.forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.MLP.training">
<code class="sig-name descname">training</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></em><a class="headerlink" href="#image_class_bs.MLP.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="image_class_bs.Spectral_image">
<em class="property">class </em><code class="sig-prename descclassname">image_class_bs.</code><code class="sig-name descname">Spectral_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">deltadeltaE</span></em>, <em class="sig-param"><span class="n">pixelsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">beam_energy</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">collection_angle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dielectric_function_im_avg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dielectric_function_im_std</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">S_s_avg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">S_s_std</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">thickness_avg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">thickness_std</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">IEELS_avg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">IEELS_std</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>This is the spectral image class that provides several tools to analyse spectral images with the zero-loss peak
subtracted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – Spectral image data as 3D numpy array (x-axis, y-axis, energy loss)</p></li>
<li><p><strong>deltadeltaE</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Binwidth in energy loss spectrum</p></li>
<li><p><strong>pixelsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – Width of pixels (the default is None, which implies …)</p></li>
<li><p><strong>beam_energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – Energy of electron beam [eV] (default is None, which implies …)</p></li>
<li><p><strong>collection_angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – Collection angle of STEM [rad] (default is None, which implies …)</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Title of the plots (default is None, in which case no title is passed)</p></li>
<li><p><strong>dielectric_function_im_avg</strong> – average dielectric function for each pixel</p></li>
<li><p><strong>dielectric_function_im_std</strong> – standard deviation of the dielectric function at each energy for each pixel</p></li>
<li><p><strong>S_s_avg</strong> – average surface scattering distribution for each pixel</p></li>
<li><p><strong>S_s_std</strong> – standard deviation of the surface scattering distribution at each energy for each pixel</p></li>
<li><p><strong>thickness_avg</strong> – average thickness for each pixel</p></li>
<li><p><strong>IEELS_avg</strong> – average bulk scattering distribution for each pixel</p></li>
<li><p><strong>IEELS_std</strong> – standard deviation of the bulk scattering distribution at each energy for each pixel</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.BEAM_ENERGY_NAMES">
<code class="sig-name descname">BEAM_ENERGY_NAMES</code><em class="property"> = ['beam_energy', 'beam_E', 'E_beam', 'E0', 'E_0']</em><a class="headerlink" href="#image_class_bs.Spectral_image.BEAM_ENERGY_NAMES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.COLLECTION_ANGLE_NAMES">
<code class="sig-name descname">COLLECTION_ANGLE_NAMES</code><em class="property"> = ['collection_angle', 'col_angle', 'beta']</em><a class="headerlink" href="#image_class_bs.Spectral_image.COLLECTION_ANGLE_NAMES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.DIELECTRIC_FUNCTION_NAMES">
<code class="sig-name descname">DIELECTRIC_FUNCTION_NAMES</code><em class="property"> = ['dielectric_function', 'dielectricfunction', 'dielec_func', 'die_fun', 'df', 'epsilon']</em><a class="headerlink" href="#image_class_bs.Spectral_image.DIELECTRIC_FUNCTION_NAMES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.EELS_NAMES">
<code class="sig-name descname">EELS_NAMES</code><em class="property"> = ['electron_energy_loss_spectrum', 'electron_energy_loss', 'EELS', 'EEL', 'energy_loss', 'data']</em><a class="headerlink" href="#image_class_bs.Spectral_image.EELS_NAMES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.IEELS_NAMES">
<code class="sig-name descname">IEELS_NAMES</code><em class="property"> = ['inelastic_scattering_energy_loss_spectrum', 'inelastic_scattering_energy_loss', 'inelastic_scattering', 'IEELS', 'IES']</em><a class="headerlink" href="#image_class_bs.Spectral_image.IEELS_NAMES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.KK_pixel">
<code class="sig-name descname">KK_pixel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="n">signal</span><span class="o">=</span><span class="default_value">'EELS'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.KK_pixel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.KK_pixel" title="Permalink to this definition">¶</a></dt>
<dd><p>Option to include pooling, not for thickness, as this is an integral and therefor         more noise robust by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>j</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>pooled</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>dielectric_functions</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>ts</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>S_ss</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>IEELSs</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.POOLED_ADDITION">
<code class="sig-name descname">POOLED_ADDITION</code><em class="property"> = ['pooled', 'pool', 'p', '_pooled', '_pool', '_p']</em><a class="headerlink" href="#image_class_bs.Spectral_image.POOLED_ADDITION" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.THICKNESS_NAMES">
<code class="sig-name descname">THICKNESS_NAMES</code><em class="property"> = ['t', 'thickness', 'thick', 'thin']</em><a class="headerlink" href="#image_class_bs.Spectral_image.THICKNESS_NAMES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.ZLP_NAMES">
<code class="sig-name descname">ZLP_NAMES</code><em class="property"> = ['zeros_loss_peak', 'zero_loss', 'ZLP', 'ZLPs', 'zlp', 'zlps']</em><a class="headerlink" href="#image_class_bs.Spectral_image.ZLP_NAMES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.a_0">
<code class="sig-name descname">a_0</code><em class="property"> = 5.29e-11</em><a class="headerlink" href="#image_class_bs.Spectral_image.a_0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.c">
<code class="sig-name descname">c</code><em class="property"> = 299792458.0</em><a class="headerlink" href="#image_class_bs.Spectral_image.c" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.calc_ZLPs">
<code class="sig-name descname">calc_ZLPs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="n">signal</span><span class="o">=</span><span class="default_value">'EELS'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.calc_ZLPs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.calc_ZLPs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.calc_avg_ci">
<em class="property">static </em><code class="sig-name descname">calc_avg_ci</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">np_array</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">ci</span><span class="o">=</span><span class="default_value">16</span></em>, <em class="sig-param"><span class="n">return_low_high</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.calc_avg_ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.calc_avg_ci" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.calc_axes">
<code class="sig-name descname">calc_axes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image_shape</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.calc_axes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.calc_axes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.calc_gen_ZLPs">
<code class="sig-name descname">calc_gen_ZLPs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.calc_gen_ZLPs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.calc_gen_ZLPs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.calc_thickness">
<code class="sig-name descname">calc_thickness</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">I_EELS</span></em>, <em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">N_ZLP</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.calc_thickness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.calc_thickness" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates thickness from sample data, using Egreton #TODO: bron.
Nota bene: does not correct for surface scatterings. If you wish to correct         for surface scatterings, please extract t from kramer_kronig_hs()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>I_EELS</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>n</strong> (<em>TYPE</em>) – DESCRIPTION.</p></li>
<li><p><strong>N_ZLP</strong> (<em>float/int</em>) – default = 1. Default for already normalized I_EELS spectra.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.check_cost_smefit">
<em class="property">static </em><code class="sig-name descname">check_cost_smefit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path_to_models</span></em>, <em class="sig-param"><span class="n">idx</span></em>, <em class="sig-param"><span class="n">threshold</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.check_cost_smefit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.check_cost_smefit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.check_model">
<em class="property">static </em><code class="sig-name descname">check_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.check_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.check_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.cluster">
<code class="sig-name descname">cluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_clusters</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">n_iterations</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">based_upon</span><span class="o">=</span><span class="default_value">'log'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.cluster" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.cluster_on_cluster_values">
<code class="sig-name descname">cluster_on_cluster_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cluster_values</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.cluster_on_cluster_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.cluster_on_cluster_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.compressed_pickle">
<em class="property">static </em><code class="sig-name descname">compressed_pickle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">title</span></em>, <em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.compressed_pickle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.compressed_pickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.crossings">
<code class="sig-name descname">crossings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.crossings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.crossings" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.crossings_ieels">
<code class="sig-name descname">crossings_ieels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ieels</span></em>, <em class="sig-param"><span class="n">smooth</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">window_len</span><span class="o">=</span><span class="default_value">50</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.crossings_ieels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.crossings_ieels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.crossings_im">
<code class="sig-name descname">crossings_im</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.crossings_im"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.crossings_im" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>INPUT:</dt><dd><p>self</p>
</dd>
<dt>OUTPUT:</dt><dd><p>self.crossings_E = numpy array (image-shape, N_c), where N_c the maximimun number of crossings of any pixel, 0 indicates no crossing
self.crossings_n = numpy array (image-shape), number of crossings per pixel</p>
</dd>
</dl>
<p>Calculates for each pixel the crossings of the real part of the dielectric function             from negative to positive.</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.cut">
<code class="sig-name descname">cut</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">E1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">E2</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">in_ex</span><span class="o">=</span><span class="default_value">'in'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.cut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.cut" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E1</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is None.</p></li>
<li><p><strong>E2</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.cut_image">
<code class="sig-name descname">cut_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">range_width</span></em>, <em class="sig-param"><span class="n">range_height</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.cut_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.cut_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.decompress_pickle">
<em class="property">static </em><code class="sig-name descname">decompress_pickle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.decompress_pickle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.decompress_pickle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.deconvolute">
<code class="sig-name descname">deconvolute</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="n">ZLP</span></em>, <em class="sig-param"><span class="n">signal</span><span class="o">=</span><span class="default_value">'EELS'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.deconvolute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.deconvolute" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.determine_deltaE">
<code class="sig-name descname">determine_deltaE</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.determine_deltaE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.determine_deltaE" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>INPUT:</dt><dd><p>self</p>
</dd>
</dl>
<p>Determines the delta energies of the spectral image, based on the delta delta energie,
and the index on which the spectral image has on average the highest intesity, this
is taken as the zero point for the delta energy.</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.get_cluster_spectra">
<code class="sig-name descname">get_cluster_spectra</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">conf_interval</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">clusters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_as_attribute</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">based_upon</span><span class="o">=</span><span class="default_value">'log'</span></em>, <em class="sig-param"><span class="n">signal</span><span class="o">=</span><span class="default_value">'EELS'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.get_cluster_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.get_cluster_spectra" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>conf_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>optional</em>) – The ratio of spectra returned. The spectra are selected based on the
based_upon value. The default is 0.68.</p></li>
<li><p><strong>clusters</strong> (<em>list of ints</em><em>, </em><em>optional #TODO: finish</em>) – DESCRIPTION. The default is None.</p></li>
<li><p><strong>save_as_attribute</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – DESCRIPTION. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>cluster_data</strong> (<em>np.array of type object, filled with 2D numpy arrays</em>) – Each cell of the super numpy array is filled with the data of all spectra
with in one of the requested clusters.</p></li>
<li><p><em>Atributes</em></p></li>
<li><p><em>———</em></p></li>
<li><p><strong>self.cluster_data</strong> (<em>np.array of type object, filled with 2D numpy arrays</em>) – If save_as_attribute set to True, the cluster data is also saved as attribute</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.get_data">
<code class="sig-name descname">get_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.get_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>returns spectra image data in 3D-numpy array (x-axis x y-axis x energy loss-axis)</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.get_deltaE">
<code class="sig-name descname">get_deltaE</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.get_deltaE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.get_deltaE" title="Permalink to this definition">¶</a></dt>
<dd><p>returns energy loss axis in numpy array</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.get_image_signals">
<code class="sig-name descname">get_image_signals</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">signal</span><span class="o">=</span><span class="default_value">'EELS'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.get_image_signals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.get_image_signals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.get_key">
<code class="sig-name descname">get_key</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.get_key"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.get_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.get_metadata">
<code class="sig-name descname">get_metadata</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.get_metadata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.get_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>returns list with values for beam_energy and collection_angle, if defined</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.get_pixel_signal">
<code class="sig-name descname">get_pixel_signal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="n">signal</span><span class="o">=</span><span class="default_value">'EELS'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.get_pixel_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.get_pixel_signal" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>INPUT:</dt><dd><p>i: int, x-coordinate for the pixel
j: int, y-coordinate for the pixel</p>
</dd>
<dt>Keyword argument:</dt><dd><p>signal: str (default = ‘EELS’), what signal is requested, should comply with defined names</p>
</dd>
<dt>OUTPUT:</dt><dd><p>signal: 1D numpy array, array with the requested signal from the requested pixel</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.get_prefix">
<em class="property">static </em><code class="sig-name descname">get_prefix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">unit</span></em>, <em class="sig-param"><span class="n">SIunit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">numeric</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.get_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.get_prefix" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>INPUT:</dt><dd><p>unit – str, unit of which the prefix is wanted
SIunit – str, default = None, the SI unit of the unit of which the prefix is wanted                         (eg ‘eV’ for ‘keV’), if None, first character of unit is evaluated as prefix
numeric – bool, default = True, if numeric the prefix is translated to the numeric value                         (e.g. 1E3 for ‘k’)</p>
</dd>
<dt>OUTPUT:</dt><dd><p>prefix – str or int, the character of the prefix or the numeric value of the prefix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.get_ticks">
<code class="sig-name descname">get_ticks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sig</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">n_tick</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.get_ticks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.get_ticks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.h_bar">
<code class="sig-name descname">h_bar</code><em class="property"> = 6.582119569e-16</em><a class="headerlink" href="#image_class_bs.Spectral_image.h_bar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.im_dielectric_function">
<code class="sig-name descname">im_dielectric_function</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">track_process</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_index</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.im_dielectric_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.im_dielectric_function" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>INPUT:</dt><dd><p>self – the image of which the dielectic functions are calculated
track_process – boolean, default = False, if True: prints for each pixel that program is busy with that pixel.
plot – boolean, default = False, if True, plots all calculated dielectric functions</p>
</dd>
<dt>OUTPUT ATRIBUTES:</dt><dd><p>self.dielectric_function_im_avg = average dielectric function for each pixel
self.dielectric_function_im_std = standard deviation of the dielectric function at each energy for each pixel
self.S_s_avg = average surface scattering distribution for each pixel
self.S_s_std = standard deviation of the surface scattering distribution at each energy for each pixel
self.thickness_avg = average thickness for each pixel
self.thickness_std = standard deviation thickness for each pixel
self.IEELS_avg = average bulk scattering distribution for each pixel
self.IEELS_std = standard deviation of the bulk scattering distribution at each energy for each pixel</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.im_dielectric_function_bs">
<code class="sig-name descname">im_dielectric_function_bs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">track_process</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save_index</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_path</span><span class="o">=</span><span class="default_value">'KK_analysis'</span></em>, <em class="sig-param"><span class="n">smooth</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.im_dielectric_function_bs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.im_dielectric_function_bs" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>track_process</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – default = False, if True: prints for each pixel that program is busy with that pixel.</p></li>
<li><p><strong>plot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – default = False, if True, plots all calculated dielectric functions</p></li>
<li><p><strong>save_index</strong> (<em>opt</em>) – </p></li>
<li><p><strong>save_path</strong> (<em>opt</em>) – </p></li>
<li><p><strong>smooth</strong> (<em>opt</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.image_shape">
<em class="property">property </em><code class="sig-name descname">image_shape</code><a class="headerlink" href="#image_class_bs.Spectral_image.image_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>return 2D-shape of spectral image</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.kramers_kronig_hs">
<code class="sig-name descname">kramers_kronig_hs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">I_EELS</span></em>, <em class="sig-param"><span class="n">N_ZLP</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">iterations</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">delta</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">correct_S_s</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.kramers_kronig_hs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.kramers_kronig_hs" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the complex
dielectric function from a single scattering distribution (SSD) using
the Kramers-Kronig relations.</p>
<p>It uses the FFT method as in <a class="footnote-reference brackets" href="#id3" id="id1">1</a>.  The SSD is an
EELSSpectrum instance containing SSD low-loss EELS with no zero-loss
peak. The internal loop is devised to approximately subtract the
surface plasmon contribution supposing an unoxidized planar surface and
neglecting coupling between the surfaces. This method does not account
for retardation effects, instrumental broading and surface plasmon
excitation in particles.</p>
<p>Note that either refractive index or thickness are required.
If both are None or if both are provided an exception is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>zlp</strong> (<em>{None</em><em>, </em><em>number</em><em>, </em><em>Signal1D}</em>) – ZLP intensity. It is optional (can be None) if <cite>t</cite> is None and <cite>n</cite>
is not None and the thickness estimation is not required. If <cite>t</cite>
is not None, the ZLP is required to perform the normalization and
if <cite>t</cite> is not None, the ZLP is required to calculate the thickness.
If the ZLP is the same for all spectra, the integral of the ZLP
can be provided as a number. Otherwise, if the ZLP intensity is not
the same for all spectra, it can be provided as i) a Signal1D
of the same dimensions as the current signal containing the ZLP
spectra for each location ii) a BaseSignal of signal dimension 0
and navigation_dimension equal to the current signal containing the
integrated ZLP intensity.</p></li>
<li><p><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of the iterations for the internal loop to remove the
surface plasmon contribution. If 1 the surface plasmon contribution
is not estimated and subtracted (the default is 1).</p></li>
<li><p><strong>n</strong> (<em>{None</em><em>, </em><em>float}</em>) – The medium refractive index. Used for normalization of the
SSD to obtain the energy loss function. If given the thickness
is estimated and returned. It is only required when <cite>t</cite> is None.</p></li>
<li><p><strong>t</strong> (<em>{None</em><em>, </em><em>number</em><em>, </em><em>Signal1D}</em>) – The sample thickness in nm. Used for normalization of the
to obtain the energy loss function. It is only required when
<cite>n</cite> is None. If the thickness is the same for all spectra it can be
<cite>n</cite> is None. If the thickness is the same for all spectra it can be
given by a number. Otherwise, it can be provided as a BaseSignal
with signal dimension 0 and navigation_dimension equal to the
current signal.</p></li>
<li><p><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – A small number (0.1-0.5 eV) added to the energy axis in
specific steps of the calculation the surface loss correction to
improve stability.</p></li>
<li><p><strong>full_output</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If True, return a dictionary that contains the estimated
thickness if <cite>t</cite> is None and the estimated surface plasmon
excitation and the spectrum corrected from surface plasmon
excitations if <cite>iterations</cite> &gt; 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>eps</strong> (<em>DielectricFunction instance</em>) –</p>
<p>The complex dielectric function results,</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[\epsilon = \epsilon_1 + i*\epsilon_2,\]</div>
</div></blockquote>
<p>contained in an DielectricFunction instance.</p>
</li>
<li><p><strong>output</strong> (<em>Dictionary (optional)</em>) – A dictionary of optional outputs with the following keys:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">thickness</span></code></dt><dd><p>The estimated  thickness in nm calculated by normalization of
the SSD (only when <cite>t</cite> is None)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">surface</span> <span class="pre">plasmon</span> <span class="pre">estimation</span></code></dt><dd><p>The estimated surface plasmon excitation (only if
<cite>iterations</cite> &gt; 1.)</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValuerError</strong> – If both <cite>n</cite> and <cite>t</cite> are undefined (None).</p></li>
<li><p><strong>AttribureError</strong> – If the beam_energy or the collection semi-angle are not defined in
    metadata.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method is based in Egerton’s Matlab code <a class="footnote-reference brackets" href="#id3" id="id2">1</a> with some
minor differences:</p>
<ul class="simple">
<li><p>The wrap-around problem when computing the ffts is workarounded by
padding the signal instead of substracting the reflected tail.</p></li>
</ul>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>)</span></dt>
<dd><p>Ray Egerton, “Electron Energy-Loss Spectroscopy in the Electron
Microscope”, Springer-Verlag, 2011.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.l">
<em class="property">property </em><code class="sig-name descname">l</code><a class="headerlink" href="#image_class_bs.Spectral_image.l" title="Permalink to this definition">¶</a></dt>
<dd><p>returns length of spectra, i.e. num energy loss bins</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.load_Spectral_image">
<em class="property">classmethod </em><code class="sig-name descname">load_Spectral_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path_to_pickle</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.load_Spectral_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.load_Spectral_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.load_ZLP_models">
<code class="sig-name descname">load_ZLP_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path_to_models</span><span class="o">=</span><span class="default_value">'models'</span></em>, <em class="sig-param"><span class="n">threshold_costs</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">name_in_path</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">plotting</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.load_ZLP_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.load_ZLP_models" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.load_ZLP_models_smefit">
<code class="sig-name descname">load_ZLP_models_smefit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path_to_models</span><span class="o">=</span><span class="default_value">'models'</span></em>, <em class="sig-param"><span class="n">threshold_costs</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">name_in_path</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">plotting</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">idx</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.load_ZLP_models_smefit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.load_ZLP_models_smefit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.load_compressed_Spectral_image">
<em class="property">classmethod </em><code class="sig-name descname">load_compressed_Spectral_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path_to_compressed_pickle</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.load_compressed_Spectral_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.load_compressed_Spectral_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.load_data">
<em class="property">classmethod </em><code class="sig-name descname">load_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path_to_dmfile</span></em>, <em class="sig-param"><span class="n">load_additional_data</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.load_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.load_data" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>INPUT:</dt><dd><p>path_to_dmfile: str, path to spectral image file (.dm3 or .dm4 extension)</p>
</dd>
<dt>OUTPUT:</dt><dd><p>image – Spectral_image, object of Spectral_image class containing the data of the dm-file</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="image_class_bs.Spectral_image.m_0">
<code class="sig-name descname">m_0</code><em class="property"> = 511.06</em><a class="headerlink" href="#image_class_bs.Spectral_image.m_0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.n_clusters">
<em class="property">property </em><code class="sig-name descname">n_clusters</code><a class="headerlink" href="#image_class_bs.Spectral_image.n_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>return number of clusters image is clustered into</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.n_spectra">
<em class="property">property </em><code class="sig-name descname">n_spectra</code><a class="headerlink" href="#image_class_bs.Spectral_image.n_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>returns number of spectra in specral image</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.plot_all">
<code class="sig-name descname">plot_all</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">same_image</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">legend</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">range_x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">range_y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">range_E</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">signal</span><span class="o">=</span><span class="default_value">'EELS'</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.plot_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.plot_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.plot_heatmap">
<code class="sig-name descname">plot_heatmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xlab</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ylab</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">'coolwarm'</span></em>, <em class="sig-param"><span class="n">discrete_colormap</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sig</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">save_as</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">color_bin_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">equal_axis</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.plot_heatmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.plot_heatmap" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>INPUT:</dt><dd><p>self – spectral image
title – str, delfault = None, title of plot
xlab – str, default = None, x-label
ylab – str, default = None, y-label</p>
</dd>
</dl>
<p>OUTPUT:
Plots the summation over the intensity for each pixel in a heatmap.</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.plot_sum">
<code class="sig-name descname">plot_sum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">title</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xlab</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ylab</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.plot_sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.plot_sum" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>INPUT:</dt><dd><p>self – spectral image
title – str, delfault = None, title of plot
xlab – str, default = None, x-label
ylab – str, default = None, y-label</p>
</dd>
</dl>
<p>OUTPUT:
Plots the summation over the intensity for each pixel in a heatmap.</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.pool">
<code class="sig-name descname">pool</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_p</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.pool" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.samenvoegen">
<code class="sig-name descname">samenvoegen</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.samenvoegen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.samenvoegen" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.save_compressed_image">
<code class="sig-name descname">save_compressed_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.save_compressed_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.save_compressed_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.save_image">
<code class="sig-name descname">save_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.save_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.save_image" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.set_n">
<code class="sig-name descname">set_n</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">n_vac</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.set_n"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.set_n" title="Permalink to this definition">¶</a></dt>
<dd><p>LET OP WELKE WAARDE n_vac is en welke n_sample</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<em>TYPE</em>) – DESCRIPTION.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.shape">
<em class="property">property </em><code class="sig-name descname">shape</code><a class="headerlink" href="#image_class_bs.Spectral_image.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>returns 3D-shape of spectral image</p>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.smooth">
<code class="sig-name descname">smooth</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">window_len</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">'hanning'</span></em>, <em class="sig-param"><span class="n">keep_original</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.smooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the begining and end part of the output signal.</p>
<dl>
<dt>input:</dt><dd><p>x: the input signal
window_len: the dimension of the smoothing window; should be an odd integer
window: the type of window from ‘flat’, ‘hanning’, ‘hamming’, ‘bartlett’, ‘blackman’</p>
<blockquote>
<div><p>flat window will produce a moving average smoothing.</p>
</div></blockquote>
</dd>
<dt>output:</dt><dd><p>the smoothed signal</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="image_class_bs.Spectral_image.train_ZLPs">
<code class="sig-name descname">train_ZLPs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_clusters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">conf_interval</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">clusters</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">signal</span><span class="o">=</span><span class="default_value">'EELS'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#Spectral_image.train_ZLPs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.Spectral_image.train_ZLPs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="image_class_bs.bandgap">
<code class="sig-prename descclassname">image_class_bs.</code><code class="sig-name descname">bandgap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">amp</span></em>, <em class="sig-param"><span class="n">BG</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#bandgap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.bandgap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="image_class_bs.find_scale_var">
<code class="sig-prename descclassname">image_class_bs.</code><code class="sig-name descname">find_scale_var</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span></em>, <em class="sig-param"><span class="n">min_out</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">max_out</span><span class="o">=</span><span class="default_value">0.9</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#find_scale_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.find_scale_var" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="image_class_bs.iCFT">
<code class="sig-prename descclassname">image_class_bs.</code><code class="sig-name descname">iCFT</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">Y_k</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#iCFT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.iCFT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="image_class_bs.round_scientific">
<code class="sig-prename descclassname">image_class_bs.</code><code class="sig-name descname">round_scientific</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">n_sig</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#round_scientific"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.round_scientific" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="image_class_bs.scale">
<code class="sig-prename descclassname">image_class_bs.</code><code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span></em>, <em class="sig-param"><span class="n">ab</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>min_inp = inp.min()
max_inp = inp.max()</p>
<p>outp = inp/(max_inp-min_inp) * (max_out-min_out)
outp -= outp.min()
outp += min_out</p>
<p>return outp</p>
</dd></dl>

<dl class="py function">
<dt id="image_class_bs.smooth_1D">
<code class="sig-prename descclassname">image_class_bs.</code><code class="sig-name descname">smooth_1D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">window_len</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">window</span><span class="o">=</span><span class="default_value">'hanning'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/image_class_bs.html#smooth_1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#image_class_bs.smooth_1D" title="Permalink to this definition">¶</a></dt>
<dd><p>smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the begining and end part of the output signal.</p>
<dl>
<dt>input:</dt><dd><p>x: the input signal
window_len: the dimension of the smoothing window; should be an odd integer
window: the type of window from ‘flat’, ‘hanning’, ‘hamming’, ‘bartlett’, ‘blackman’</p>
<blockquote>
<div><p>flat window will produce a moving average smoothing.</p>
</div></blockquote>
</dd>
<dt>output:</dt><dd><p>the smoothed signal</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, A

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>