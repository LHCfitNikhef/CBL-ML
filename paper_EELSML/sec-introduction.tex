\section{Introduction}
\label{sec:introduction}

Electron energy-loss spectroscopy (EELS) within the transmission electron microscope (TEM) provides
valuable information on the structural, chemical, and electronic properties of nanoscale materials.
%
Thanks to recent instrumentation breakthroughs
such as electron monochromators and aberration correctors,
modern EELS analyses can map these properties with unprecedented spatial and spectral resolution.
%
A particularly important region of the EEL spectra is
the low-loss region, defined by those electrons that have lost
less than a few eV ($\Delta E\lsim 5$ GeV) following their inelastic interactions
with the sample.
%
The analysis of this low-loss region makes possible charting the local
electronic properties of nanomaterials, from the characterisation of
 bulk and surface plasmons, excitons, inter- and intra-band transitions,
and phonons to
the determination of their bandgap and band structure~\cite{Stoger:2008}.

Provided the sample is electron-transparent, as required for TEM inspection,
in EELS
the bulk of the incident electron beam will traverse it
either without interacting or restricted to elastic scatterings.
%
The resulting energy exchanges contribute to a narrow,
 high intensity peak centered at energy losses
of $\Delta E\simeq 0$ and known as the zero loss peak (ZLP).
%
The energy resolution of EELS analyses is ultimately determined by
the electron beam size of the system, often expressed in terms
of the full width at half maximum (FWHM) of the
ZLP~\cite{Egerton:2009}.
%
In the low-loss region, the contribution from the ZLP
often overwhelms that from 
from the inelastic scatterings associated with the interactions of the fast electrons
with the sample.
%
Therefore, signals of relevant low-loss phenomena such as excitons,
phonons, and intraband transitions risk being drowned
in ZLP tail~\cite{Abajo:2010}.
%
The accurate removal of the ZLP
contribution is thus crucial  in order to efficiently chart and identify the  features
of the low-loss  region of EEL spectra. 

The properties of the ZLP in monochromated EELS depend on the electron energy dispersion,
the monochromator alignment, and the sample thickness~\cite{Park:2008, Stoger:2008}.
%
The first two factors arise already in the absence of a specimen, while the third one is associated
to elastic scatterings with the sample such as  phonon excitation and exciton losses.
%
For this reason, measurements of EEL spectra taken in vacuum can only be used for calibration purposes
but are not suitable
to subtract the ZLP from spectra taken on specimens, since their shapes will be in general
different.

Several approaches to ZLP subtraction have been put forward in the literature.
%
These are based on specific model assumptions about the ZLP properties, specifically
concerning its parametric functional dependence, from Lorentzian~\cite{Dorneich:1998}
and power laws~\cite{Erni:2005} to more general multiple-parameter functions~\cite{Benthem:2001}.
%
Another approach is based on the mirroring the $\Delta E <0$ region of the spectra, assuming
that the $\Delta E>0$ region is fully symmetric~\cite{Lazar:2003}.
%
These  subtraction methods are however affected by three main limitations.
%
Firstly, they rely on specific model assumptions {\it e.g.} with
the choice of functional form, introducing a methodological
bias whose size is difficult to quantify.
%
Secondly, they lack an estimate of the associated uncertainties, which in turn affects
the reliability of any physical interpretations of the low loss region such as the band gap extraction.
%
Thirdly, {\it ad hoc} choices of such as those of the fitting ranges introduce a significant degree of
arbitrariness in the procedure.

Here we bypass these limitations by developing a model-independent strategy
for ZLP subtractions in EELS by means of machine learning (ML) techniques.
%
Our strategy is based on the NNPDF approach~\cite{Ball:2008by,Ball:2012cx,Ball:2014uwa,Ball:2017nwa}
developed for studies
of the quark and gluon structure of protons in high-energy particle collisions.
%
The main idea is to combine the  Monte Carlo replica  method to construct a probability
distribution in the space of experimental data with artificial
neural networks as unbiased interpolators to describe the ZLP.
%
This way one achieves
a faithful sampling of the probability distribution in the space of ZLP,
which then can be applied to subtract its contribution to EEL spectra while keeping
full track of all the associated
data, model, and parametrisation uncertainties.
%
This approach is amenable to assembling high-dimensionality parametrisations
of ZLP spectra with multiple inputs, and extrapolate them reliably
to other operation conditions of the microscope beyond those included
in the training dataset.

In recent years
machine learning techniques have been deployed in several studies
related to transmission electron microscopy methods
in the context of material science.
%
Representative examples
include the automated identification
of atomic-level structural information~\cite{10.1145/2834892.2834896},
the extraction of chemical information
and defect classification~\cite{doi:10.1021/acsnano.7b07504},
and spatial resolution enhancement
using  using a generative adversarial network~\cite{cite-key}.
%
Our work represents to the best of our knowledge
the first time that neural networks are used as 
 unbiased
background removal interpolators, and combined with Monte Carlo sampling to construct a faithful estimate
of the ML model uncertainties.

Our study is composed of two main parts.
%
In the first one, we construct a ML model of the ZLP spectra taken
in vacuum which accommodates an  arbitrary number of input
variables corresponding to different operation conditions of the TEM.
%
We demonstrate how the model describes successfully all the
input spectra and assess its extrapolation for other operation
conditions.
%
In the second part, we apply the same techniques to
the parametrisation of the ZLP from spectra taken on sample specimens.
%
Here one has to be careful to define the fitting ranges
in an automated way while avoiding contamination from
the signal associated to inelastic scatterings.
%
We carefully validate our fitting methodology by means of closure tests, were
artificial pseudo-data based on a known underlying model is generated
to compare with the model output.

As a proof of concept, we apply the machine learning ZLP removal technique
developed here to map the local electronic properties
from a low-loss region analysis of EELS taken on
MoS$_2$ nanostructures~\cite{soniamos2}.
%
MoS$_2$ is a highly promising material exhibiting a wide range of possible applications for electronic and optical devices.
%
In particular, we study the possible metallic character and
determine the value of its
bandgap in different regions of the nanostructures.
%
We will also quantify the statistical significance of the inelastic
scattering signals in the low-loss region following the ZLP
background subtraction.

The paper is organized as follows.
%
First of all in Sect.~\ref{sec:dataset}
summarize the main features of the experimental data.
%
In Sect.~\ref{sec:methodology} we describe our methodology
and discuss its application to the in-vacuum and in-sample
ZLP parametrisations.
%
In Sect.~\ref{sec:results} we present the main results
of this work and the corresponding physical interpretation
of the ZLP-subtracted low-loss EEL spectra.
%
Finally in Sect.~\ref{sec:summary} we summarise
and outline possible future developments.
